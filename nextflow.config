
trace {
    enabled = true
    raw = true
}


process {
    withLabel: 'meta' {
        container = 'bentsherman/nextflow:23.08.0-edge'

        errorStrategy = 'retry'
        maxRetries = { params.meta_memory_values.size() - 1 }

        cpus = 2
        memory = { params.meta_memory_values[task.attempt - 1] }
    }
}


profiles {
    local {
        executor.name = 'local'
        executor.cpus = 1

        process {
            withLabel: 'meta' {
                maxRetries = 1
                afterScript = 'rm -rf work'
            }
        }
    }

    index_small {
        params.download_index = "$baseDir/index-small.txt"
    }
    index_medium {
        params.download_index = "$baseDir/index-medium.txt"
    }
    index_large {
        params.download_index = "$baseDir/index-large.txt"
    }
}
